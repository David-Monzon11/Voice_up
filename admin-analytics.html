<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iReportPH - Analytics</title>
    <link rel="icon" type="image/png" href="./logo.png">
    <link rel="stylesheet" href="./admin-dashboard.css">
    <link rel="stylesheet" href="./style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="layout">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">
            <span></span>
        </button>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-brand-area">
                <div class="brand-icon">
                    <img src="./logo.png" alt="iReportPH Logo" class="brand-logo">
                </div>
                <div class="brand-details">
                    <span class="brand-title">iReportPH</span>
                    <span class="brand-subtitle">Admin Control</span>
                </div>
            </div>

            <div class="sidebar-user-card">
                <div class="user-avatar" id="userAvatar">A</div>
                <div class="user-meta">
                    <div class="user-name" id="userName">Admin</div>
                    <div class="user-email" id="adminEmail">admin@example.com</div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <a href="./admin.html" class="nav-link nav-link-ghost">
                        <span class="nav-link-icon">üìä</span>
                        <span class="nav-link-text">Dashboard</span>
                    </a>
                    <a href="./admin-solved.html" class="nav-link nav-link-ghost">
                        <span class="nav-link-icon">‚úÖ</span>
                        <span class="nav-link-text">Solved Complaints</span>
                    </a>
                    <a href="./admin-analytics.html" class="nav-link active">
                        <span class="nav-link-icon">üìà</span>
                        <span class="nav-link-text">Analytics</span>
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="sidebar-support">
                    <div class="support-icon">‚ÑπÔ∏è</div>
                    <div class="support-copy">
                        Need help?<br>
                        <a href="mailto:ireportph.help@gmail.com">Contact support</a>
                    </div>
                </div>
                <button class="sidebar-footer-btn" id="logoutBtn">
                    Log out
                </button>
            </div>
        </aside>
        <main class="content">
            <div class="container">
                <!-- Analytics Header -->
                <div class="dashboard-header">
                    <div class="dashboard-header-text">
                        <h1>System Analytics</h1>
                        <p id="analyticsSubtitle">Comprehensive insights and statistics</p>
                    </div>
                    <button id="adminThemeToggle" class="theme-toggle-btn" aria-label="Switch theme">
                        <span class="toggle-icon">üåô</span>
                        <span class="toggle-label">Dark mode</span>
                    </button>
                </div>

                <!-- Time Range Filter -->
                <div class="analytics-filters">
                    <button class="filter-btn active" data-range="all">All Time</button>
                    <button class="filter-btn" data-range="month">Last Month</button>
                    <button class="filter-btn" data-range="week">Last Week</button>
                    <button class="filter-btn" data-range="day">Today</button>
                </div>

                <!-- Key Metrics -->
                <div class="analytics-metrics-grid">
                    <div class="analytics-metric-card">
                        <div class="metric-icon">üìä</div>
                        <div class="metric-content">
                            <div class="metric-value" id="totalComplaints">0</div>
                            <div class="metric-label">Total Complaints</div>
                        </div>
                    </div>
                    <div class="analytics-metric-card">
                        <div class="metric-icon">‚ö°</div>
                        <div class="metric-content">
                            <div class="metric-value" id="avgResponseTime">0</div>
                            <div class="metric-label">Avg Response Time</div>
                        </div>
                    </div>
                    <div class="analytics-metric-card">
                        <div class="metric-icon">‚úÖ</div>
                        <div class="metric-content">
                            <div class="metric-value" id="resolutionRate">0%</div>
                            <div class="metric-label">Resolution Rate</div>
                        </div>
                    </div>
                    <div class="analytics-metric-card">
                        <div class="metric-icon">üë•</div>
                        <div class="metric-content">
                            <div class="metric-value" id="activeUsers">0</div>
                            <div class="metric-label">Active Users</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="analytics-charts-grid">
                    <!-- Complaints Over Time -->
                    <div class="analytics-chart-card">
                        <div class="chart-header">
                            <h3>Complaints Over Time</h3>
                            <p class="chart-subtitle">Trend of complaints submitted</p>
                        </div>
                        <div class="chart-container">
                            <canvas id="timeChart"></canvas>
                        </div>
                    </div>

                    <!-- Status Distribution -->
                    <div class="analytics-chart-card">
                        <div class="chart-header">
                            <h3>Status Distribution</h3>
                            <p class="chart-subtitle">Breakdown by status</p>
                        </div>
                        <div class="chart-container">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>

                    <!-- Category Distribution -->
                    <div class="analytics-chart-card">
                        <div class="chart-header">
                            <h3>Category Distribution</h3>
                            <p class="chart-subtitle">Most reported categories</p>
                        </div>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>

                    <!-- Priority Distribution -->
                    <div class="analytics-chart-card">
                        <div class="chart-header">
                            <h3>Priority Distribution</h3>
                            <p class="chart-subtitle">Urgency levels breakdown</p>
                        </div>
                        <div class="chart-container">
                            <canvas id="priorityChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Additional Insights -->
                <div class="analytics-insights-grid">
                    <!-- Top Locations -->
                    <div class="analytics-insight-card">
                        <div class="insight-header">
                            <h3>üìç Top Locations</h3>
                        </div>
                        <div class="insight-content" id="topLocations">
                            <div class="loading-text">Loading...</div>
                        </div>
                    </div>

                    <!-- Response Time Trends -->
                    <div class="analytics-insight-card">
                        <div class="insight-header">
                            <h3>‚è±Ô∏è Response Time Trends</h3>
                        </div>
                        <div class="insight-content">
                            <div class="response-time-stats">
                                <div class="response-stat">
                                    <span class="response-label">Fastest:</span>
                                    <span class="response-value" id="fastestResponse">-</span>
                                </div>
                                <div class="response-stat">
                                    <span class="response-label">Average:</span>
                                    <span class="response-value" id="averageResponse">-</span>
                                </div>
                                <div class="response-stat">
                                    <span class="response-label">Slowest:</span>
                                    <span class="response-value" id="slowestResponse">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Status Trends -->
                    <div class="analytics-insight-card">
                        <div class="insight-header">
                            <h3>üìà Status Trends</h3>
                        </div>
                        <div class="insight-content">
                            <div class="status-trends" id="statusTrends">
                                <div class="loading-text">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module" src="./firebase-config.js"></script>
    <script type="module">
        import { onAuthChange, logoutUser, isAdmin } from './auth.js';
        import { getAllComplaints, getAllUsers } from './admin-dashboard.js';

        const adminEmail = document.getElementById('adminEmail');
        const userName = document.getElementById('userName');
        const userAvatar = document.getElementById('userAvatar');
        const logoutBtn = document.getElementById('logoutBtn');
        const adminThemeToggle = document.getElementById('adminThemeToggle');

        let allComplaints = [];
        let allUsers = [];
        let currentRange = 'all';
        let timeChart, statusChart, categoryChart, priorityChart;

        const THEME_STORAGE_KEY = 'ireport-theme';
        const themeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        let adminThemeLocked = false;

        initializeThemeControls();

        function initializeThemeControls() {
            const storedTheme = localStorage.getItem(THEME_STORAGE_KEY);
            const prefersDark = themeMediaQuery.matches;
            adminThemeLocked = !!storedTheme;
            const initialTheme = storedTheme || (prefersDark ? 'dark' : 'light');
            applyTheme(initialTheme, adminThemeLocked);

            if (adminThemeToggle) {
                adminThemeToggle.addEventListener('click', () => {
                    const current = document.documentElement.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
                    const nextTheme = current === 'light' ? 'dark' : 'light';
                    adminThemeLocked = true;
                    applyTheme(nextTheme, true);
                });
            }

            themeMediaQuery.addEventListener('change', event => {
                if (!adminThemeLocked) {
                    applyTheme(event.matches ? 'dark' : 'light', false);
                }
            });
        }

        function applyTheme(theme, persistSelection) {
            if (theme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
            } else {
                document.documentElement.removeAttribute('data-theme');
                theme = 'dark';
            }

            if (persistSelection) {
                localStorage.setItem(THEME_STORAGE_KEY, theme);
            } else {
                localStorage.removeItem(THEME_STORAGE_KEY);
            }

            updateThemeToggle(theme);
            updateChartsTheme();
        }

        function updateThemeToggle(theme) {
            if (!adminThemeToggle) return;
            const isLight = theme === 'light';
            const iconEl = adminThemeToggle.querySelector('.toggle-icon');
            const labelEl = adminThemeToggle.querySelector('.toggle-label');
            if (iconEl) iconEl.textContent = isLight ? 'üåô' : '‚òÄÔ∏è';
            if (labelEl) labelEl.textContent = isLight ? 'Dark mode' : 'Light mode';
        }

        function getThemeColors() {
            const isLight = document.documentElement.getAttribute('data-theme') === 'light';
            return {
                text: isLight ? '#003459' : '#f8fafc',
                muted: isLight ? '#577089' : '#a5b4cb',
                grid: isLight ? 'rgba(0, 52, 89, 0.1)' : 'rgba(148, 163, 184, 0.1)',
                background: isLight ? '#ffffff' : '#141b2d'
            };
        }

        function updateChartsTheme() {
            const colors = getThemeColors();
            const chartOptions = {
                plugins: {
                    legend: {
                        labels: { color: colors.text }
                    }
                },
                scales: {
                    x: {
                        ticks: { color: colors.muted },
                        grid: { color: colors.grid }
                    },
                    y: {
                        ticks: { color: colors.muted },
                        grid: { color: colors.grid }
                    }
                }
            };

            if (timeChart) timeChart.options = { ...timeChart.options, ...chartOptions };
            if (statusChart) statusChart.options = { ...statusChart.options, ...chartOptions };
            if (categoryChart) categoryChart.options = { ...categoryChart.options, ...chartOptions };
            if (priorityChart) priorityChart.options = { ...priorityChart.options, ...chartOptions };

            [timeChart, statusChart, categoryChart, priorityChart].forEach(chart => {
                if (chart) chart.update();
            });
        }

        onAuthChange(async (user) => {
            if (!user) {
                window.location.href = 'Login.html';
                return;
            }
            const ok = await isAdmin();
            if (!ok) {
                window.location.href = 'dashboard.html';
                return;
            }
            const email = user.email || '';
            const displayName = user.displayName || 'Admin';
            adminEmail.textContent = email || displayName;
            userName.textContent = displayName;
            userAvatar.textContent = (displayName || email || 'A').charAt(0).toUpperCase();

            // Load complaints and users
            getAllComplaints((complaints) => {
                allComplaints = complaints;
                updateAnalytics();
            });

            getAllUsers((users) => {
                allUsers = users.filter(u => u.role !== 'admin');
                updateAnalytics();
            });
        });

        logoutBtn.addEventListener('click', async (e) => {
            e.preventDefault();
            try {
                const r = await logoutUser();
                if (r.success) {
                    window.location.href = 'Login.html';
                } else {
                    alert(r.error || 'Logout failed. Please try again.');
                }
            } catch (err) {
                console.error('Logout error:', err);
                alert('An error occurred during logout.');
            }
        });

        // Time range filter
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentRange = btn.dataset.range;
                updateAnalytics();
            });
        });

        function filterByRange(complaints) {
            const now = Date.now();
            const ranges = {
                day: 24 * 60 * 60 * 1000,
                week: 7 * 24 * 60 * 60 * 1000,
                month: 30 * 24 * 60 * 60 * 1000
            };

            if (currentRange === 'all') return complaints;
            const cutoff = now - ranges[currentRange];
            return complaints.filter(c => (c.createdAt || 0) >= cutoff);
        }

        function updateAnalytics() {
            const filtered = filterByRange(allComplaints);
            updateMetrics(filtered);
            updateCharts(filtered);
            updateInsights(filtered);
        }

        function updateMetrics(complaints) {
            const total = complaints.length;
            document.getElementById('totalComplaints').textContent = total;

            // Resolution rate
            const resolved = complaints.filter(c => c.status === 'resolved').length;
            const resolutionRate = total > 0 ? ((resolved / total) * 100).toFixed(1) : 0;
            document.getElementById('resolutionRate').textContent = resolutionRate + '%';

            // Average response time
            const resolvedComplaints = complaints.filter(c => c.status === 'resolved' && c.createdAt && c.updatedAt);
            if (resolvedComplaints.length > 0) {
                const totalTime = resolvedComplaints.reduce((sum, c) => {
                    return sum + (c.updatedAt - c.createdAt);
                }, 0);
                const avgTime = totalTime / resolvedComplaints.length;
                document.getElementById('avgResponseTime').textContent = formatDuration(avgTime);
            } else {
                document.getElementById('avgResponseTime').textContent = 'N/A';
            }

            // Active users (users who submitted complaints in the range)
            const uniqueUsers = new Set(complaints.map(c => c.userId).filter(Boolean));
            document.getElementById('activeUsers').textContent = uniqueUsers.size;
        }

        function formatDuration(ms) {
            const days = Math.floor(ms / (24 * 60 * 60 * 1000));
            const hours = Math.floor((ms % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));
            if (days > 0) return `${days}d ${hours}h`;
            if (hours > 0) return `${hours}h`;
            const minutes = Math.floor((ms % (60 * 60 * 1000)) / (60 * 1000));
            return `${minutes}m`;
        }

        function updateCharts(complaints) {
            const colors = getThemeColors();
            const isLight = document.documentElement.getAttribute('data-theme') === 'light';

            // Time Chart
            const timeData = getTimeSeriesData(complaints);
            const timeCtx = document.getElementById('timeChart').getContext('2d');
            if (timeChart) timeChart.destroy();
            timeChart = new Chart(timeCtx, {
                type: 'line',
                data: {
                    labels: timeData.labels,
                    datasets: [{
                        label: 'Complaints',
                        data: timeData.values,
                        borderColor: isLight ? '#007ea7' : '#6366f1',
                        backgroundColor: isLight ? 'rgba(0, 126, 167, 0.1)' : 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: colors.text } }
                    },
                    scales: {
                        x: { ticks: { color: colors.muted }, grid: { color: colors.grid } },
                        y: { ticks: { color: colors.muted }, grid: { color: colors.grid }, beginAtZero: true }
                    }
                }
            });

            // Status Chart
            const statusData = getStatusData(complaints);
            const statusCtx = document.getElementById('statusChart').getContext('2d');
            if (statusChart) statusChart.destroy();
            statusChart = new Chart(statusCtx, {
                type: 'doughnut',
                data: {
                    labels: statusData.labels,
                    datasets: [{
                        data: statusData.values,
                        backgroundColor: [
                            isLight ? 'rgba(250, 204, 21, 0.8)' : 'rgba(250, 204, 21, 0.6)',
                            isLight ? 'rgba(0, 112, 192, 0.8)' : 'rgba(56, 189, 248, 0.6)',
                            isLight ? 'rgba(34, 197, 94, 0.8)' : 'rgba(34, 197, 94, 0.6)',
                            isLight ? 'rgba(248, 113, 113, 0.8)' : 'rgba(248, 113, 113, 0.6)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { color: colors.text, padding: 15 } }
                    }
                }
            });

            // Category Chart
            const categoryData = getCategoryData(complaints);
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            if (categoryChart) categoryChart.destroy();
            categoryChart = new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: categoryData.labels,
                    datasets: [{
                        label: 'Complaints',
                        data: categoryData.values,
                        backgroundColor: isLight ? 'rgba(0, 126, 167, 0.7)' : 'rgba(99, 102, 241, 0.7)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: { ticks: { color: colors.muted }, grid: { color: colors.grid } },
                        y: { ticks: { color: colors.muted }, grid: { color: colors.grid }, beginAtZero: true }
                    }
                }
            });

            // Priority Chart
            const priorityData = getPriorityData(complaints);
            const priorityCtx = document.getElementById('priorityChart').getContext('2d');
            if (priorityChart) priorityChart.destroy();
            priorityChart = new Chart(priorityCtx, {
                type: 'pie',
                data: {
                    labels: priorityData.labels,
                    datasets: [{
                        data: priorityData.values,
                        backgroundColor: [
                            isLight ? 'rgba(34, 197, 94, 0.8)' : 'rgba(34, 197, 94, 0.6)',
                            isLight ? 'rgba(250, 204, 21, 0.8)' : 'rgba(250, 204, 21, 0.6)',
                            isLight ? 'rgba(248, 113, 113, 0.8)' : 'rgba(248, 113, 113, 0.6)',
                            isLight ? 'rgba(190, 24, 93, 0.8)' : 'rgba(190, 24, 93, 0.6)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { color: colors.text, padding: 15 } }
                    }
                }
            });
        }

        function getTimeSeriesData(complaints) {
            const now = Date.now();
            const days = currentRange === 'day' ? 24 : currentRange === 'week' ? 7 : currentRange === 'month' ? 30 : 90;
            const labels = [];
            const values = [];
            const buckets = {};

            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(now - i * 24 * 60 * 60 * 1000);
                const key = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                labels.push(key);
                buckets[key] = 0;
            }

            complaints.forEach(c => {
                if (c.createdAt) {
                    const date = new Date(c.createdAt);
                    const key = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    if (buckets[key] !== undefined) {
                        buckets[key]++;
                    }
                }
            });

            labels.forEach(label => {
                values.push(buckets[label] || 0);
            });

            return { labels, values };
        }

        function getStatusData(complaints) {
            const statuses = ['pending', 'in_progress', 'resolved', 'rejected'];
            const counts = { pending: 0, in_progress: 0, resolved: 0, rejected: 0 };
            
            complaints.forEach(c => {
                const status = c.status || 'pending';
                if (counts[status] !== undefined) {
                    counts[status]++;
                }
            });

            return {
                labels: ['Pending', 'In Progress', 'Resolved', 'Rejected'],
                values: [counts.pending, counts.in_progress, counts.resolved, counts.rejected]
            };
        }

        function getCategoryData(complaints) {
            const categories = {};
            complaints.forEach(c => {
                const cat = c.category || 'Uncategorized';
                categories[cat] = (categories[cat] || 0) + 1;
            });

            const sorted = Object.entries(categories)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8);

            return {
                labels: sorted.map(([cat]) => cat),
                values: sorted.map(([, count]) => count)
            };
        }

        function getPriorityData(complaints) {
            const priorities = { low: 0, medium: 0, high: 0, urgent: 0 };
            complaints.forEach(c => {
                const priority = (c.priority || 'medium').toLowerCase();
                if (priorities[priority] !== undefined) {
                    priorities[priority]++;
                }
            });

            return {
                labels: ['Low', 'Medium', 'High', 'Urgent'],
                values: [priorities.low, priorities.medium, priorities.high, priorities.urgent]
            };
        }

        function updateInsights(complaints) {
            // Top Locations
            const locations = {};
            complaints.forEach(c => {
                if (c.location) {
                    const loc = c.location.split(',')[0].trim();
                    locations[loc] = (locations[loc] || 0) + 1;
                }
            });

            const topLocations = Object.entries(locations)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);

            const locationsHtml = topLocations.length > 0
                ? topLocations.map(([loc, count]) => `
                    <div class="location-item">
                        <span class="location-name">${loc}</span>
                        <span class="location-count">${count}</span>
                    </div>
                `).join('')
                : '<div class="no-data">No location data</div>';

            document.getElementById('topLocations').innerHTML = locationsHtml;

            // Response Time Stats
            const resolvedComplaints = complaints.filter(c => c.status === 'resolved' && c.createdAt && c.updatedAt);
            if (resolvedComplaints.length > 0) {
                const times = resolvedComplaints.map(c => c.updatedAt - c.createdAt);
                const fastest = Math.min(...times);
                const slowest = Math.max(...times);
                const average = times.reduce((a, b) => a + b, 0) / times.length;

                document.getElementById('fastestResponse').textContent = formatDuration(fastest);
                document.getElementById('averageResponse').textContent = formatDuration(average);
                document.getElementById('slowestResponse').textContent = formatDuration(slowest);
            } else {
                document.getElementById('fastestResponse').textContent = 'N/A';
                document.getElementById('averageResponse').textContent = 'N/A';
                document.getElementById('slowestResponse').textContent = 'N/A';
            }

            // Status Trends
            const statusCounts = getStatusData(complaints);
            const trendsHtml = statusCounts.labels.map((label, i) => {
                const count = statusCounts.values[i];
                const percentage = complaints.length > 0 ? ((count / complaints.length) * 100).toFixed(1) : 0;
                return `
                    <div class="trend-item">
                        <span class="trend-label">${label}</span>
                        <div class="trend-bar-container">
                            <div class="trend-bar" style="width: ${percentage}%"></div>
                        </div>
                        <span class="trend-value">${count} (${percentage}%)</span>
                    </div>
                `;
            }).join('');

            document.getElementById('statusTrends').innerHTML = trendsHtml || '<div class="no-data">No data available</div>';
        }

        // Mobile sidebar toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');

        function toggleSidebar() {
            if (window.innerWidth <= 900) {
                sidebar.classList.toggle('open');
                sidebarOverlay.classList.toggle('active');
                mobileMenuBtn.classList.toggle('active');
            }
        }

        function closeSidebar() {
            if (window.innerWidth <= 900) {
                sidebar.classList.remove('open');
                sidebarOverlay.classList.remove('active');
                mobileMenuBtn.classList.remove('active');
            }
        }

        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', toggleSidebar);
        }

        if (sidebarOverlay) {
            sidebarOverlay.addEventListener('click', closeSidebar);
        }

        // Close sidebar when clicking on nav links (mobile)
        const navLinks = document.querySelectorAll('.nav-link');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                if (window.innerWidth <= 900) {
                    closeSidebar();
                }
            });
        });

        // Close sidebar on window resize if it becomes desktop view
        window.addEventListener('resize', () => {
            if (window.innerWidth > 900) {
                closeSidebar();
            }
        });
    </script>
</body>
</html>
